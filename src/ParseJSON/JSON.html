<!DOCTYPE html> 
<html> 
    <head> 
        <meta charset="UTF-8">
        <title>JSONExample</title>
        <style> 
        </style>  
    </head> 
    <body> 
        <button id = "students" onclick="NewTab()">students</button>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script src="JSON.php"></script>
        <script> 
            //IMPORTANT
            //need moesif CORS chrome add on
            //get html from url and get all paragraph tags
           function NewTab() {
                var request = new XMLHttpRequest();
                request.open("GET", "https://www.geeksforgeeks.org", true); //get html code from url.Must change to virtus later
                request.onreadystatechange = function() {
                    if(request.readyState === XMLHttpRequest.DONE) {
                        var status = request.status;
                        if (status === 0 || (status >= 200 && status < 400)) {
                            var parser = new DOMParser();
                            var htmlDoc = parser.parseFromString(request.responseText, "text/html") //get as text
                            window.alert(htmlDoc);
                            x = htmlDoc.getElementsByTagName("p"); //get all paragraph elements of html
                            for(var i = 0;i < x.length;i++){
                                window.alert(x[i].firstChild.nodeValue); //display each paragraph element text
                            }
                        } else {
                            window.alert("error");
                        }
                    }
                };
                request.send(null);               
            } 
        </script>
        <p id = "stringJson" onmouseover="myFunction()">[{"subject":"COMS","unitStatus":"ENROLLED","unitCode":"COMS1015A","studentNumber":"710178","expiryDate":"2020-06-30 00:00:00","sessionCode":"SM1","classSection":"A","surname":"Moyo","firstName":"Nokuthaba"},{"subject":"COMS","unitStatus":"ENROLLED","unitCode":"COMS1015A","studentNumber":"710178","expiryDate":"2020-06-30 00:00:00","sessionCode":"SM1","classSection":"A","surname":"Moyo","firstName":"Nokuthaba"},{"subject":"COMS","unitStatus":"ENROLLED","unitCode":"COMS1015A","studentNumber":"710178","expiryDate":"2020-06-30 00:00:00","sessionCode":"SM1","classSection":"A","surname":"Moyo","firstName":"Nokuthaba"}]</p>
        <script> 
            function myFunction() { 
                var stringIn = document.getElementById("stringJson").firstChild.nodeValue; //get text in p element from above to test
                document.getElementById("stringJson").innerHTML = stringIn;                 //must get from NewTab function when we have access to Virtus
                //window.alert(stringIn);
                var jsonObj = JSON.parse(stringIn);
                //window.alert(jsonObj[1]);
                var str_json = JSON.stringify(jsonObj);
                $("#debug").text(JSON.stringify(jsonObj));
                $.ajax({
                    type: 'POST',
                    url: 'http://localhost:80/JSONphp/JSON.php',    //send json obj to php file on server
                    data: {'json': JSON.stringify(jsonObj)},
                    dataType: "text",  
                    success: function( data, status, xhr ) {
                        window.alert("success");
                        window.alert(data);
                    },
                    error: function( xhr, status, error ) {
                        window.alert(error);
                        window.alert(status);
                    }  
                });
            }
        </script>
    </body> 
</html>